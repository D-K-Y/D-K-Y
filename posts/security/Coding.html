<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secure Coding: Best Practices Guide | Deepak Kumar Yadav</title>
    <link rel="stylesheet" href="../../css/styles.css">
    <link rel="stylesheet" href="../../css/blog-post.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/pyodide@0.24.1/pyodide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        .code-block { 
            background: #f8f9fa; 
            border-radius: 8px; 
            padding: 1rem; 
            margin: 1.5rem 0; 
            overflow-x: auto;
            border-left: 4px solid #007bff;
        }
        pre { margin: 0; font-family: 'Courier New', monospace; }
        .good-practice { border-left-color: #28a745; background: #d4f4dd; }
        .bad-practice { border-left-color: #dc3545; background: #f8d7da; }
        
        .info-box { 
            background: #e3f2fd; 
            border-left: 5px solid #1976d2; 
            padding: 1rem 1.5rem; 
            margin: 1.5rem 0; 
            border-radius: 8px; 
        }
        .warning-box { 
            background: #fff3cd; 
            border-left: 5px solid #ffc107; 
            padding: 1rem 1.5rem; 
            margin: 1.5rem 0; 
            border-radius: 8px; 
        }
        .danger-box { 
            background: #f8d7da; 
            border-left: 5px solid #dc3545; 
            padding: 1rem 1.5rem; 
            margin: 1.5rem 0; 
            border-radius: 8px; 
        }
        .success-box { 
            background: #d4edda; 
            border-left: 5px solid #28a745; 
            padding: 1rem 1.5rem; 
            margin: 1.5rem 0; 
            border-radius: 8px; 
        }
        
        .vulnerability-showcase {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .vulnerability-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-top: 4px solid #dc3545;
        }
        
        .secure-card {
            border-top-color: #28a745;
        }
        
        .vulnerability-card h4 {
            color: #dc3545;
            margin-top: 0;
        }
        
        .secure-card h4 {
            color: #28a745;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin: 2rem 0;
        }
        
        .comparison-section h5 {
            text-align: center;
            padding: 0.5rem;
            border-radius: 5px;
            margin: 0 0 1rem 0;
        }
        
        .vulnerable-section h5 {
            background: #f8d7da;
            color: #721c24;
        }
        
        .secure-section h5 {
            background: #d4edda;
            color: #155724;
        }
        
        .interactive-demo { 
            background: #f8f9fa; 
            border-radius: 10px; 
            padding: 1.5rem; 
            margin: 2rem 0; 
            border: 2px solid #007bff;
        }
        
        .demo-tabs {
            display: flex;
            margin-bottom: 1rem;
            border-bottom: 2px solid #dee2e6;
        }
        
        .tab-button {
            background: #f8f9fa;
            border: none;
            padding: 0.5rem 1rem;
            cursor: pointer;
            border-radius: 5px 5px 0 0;
            margin-right: 0.25rem;
        }
        
        .tab-button.active {
            background: #007bff;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .code-editor {
            border: 1px solid #ddd;
            border-radius: 5px;
            margin: 1rem 0;
            min-height: 300px;
        }
        
        .run-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            margin: 0.5rem 0.5rem 0.5rem 0;
        }
        
        .run-button:hover {
            background: #218838;
        }
        
        .output {
            background: #2d3748;
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 5px;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            min-height: 100px;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .checklist { 
            background: #f8f9fa; 
            border-radius: 10px; 
            padding: 2rem; 
            margin: 2rem 0; 
        }
        
        .checklist ul { list-style: none; padding: 0; }
        
        .checklist li { 
            margin: 0.5rem 0; 
            padding: 0.5rem; 
            background: white; 
            border-radius: 5px; 
            border-left: 4px solid #28a745; 
        }
        
        .owasp-top10 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }
        
        .owasp-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }
        
        .owasp-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #dc3545, #fd7e14, #ffc107);
        }
        
        .owasp-item h4 {
            color: #dc3545;
            margin-top: 0;
        }
        
        .secrets-management {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 10px;
            margin: 2rem 0;
        }
        
        .security-tools {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .tool-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-top: 4px solid #007bff;
        }
        
        .tool-card h4 {
            color: #007bff;
            margin-top: 0;
        }
        
        @media (max-width: 768px) {
            .vulnerability-showcase,
            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="nav-brand">
                <a href="../../index.html">Deepak Kumar Yadav</a>
            </div>
            <ul>
                <li><a href="../../blog.html">Blog</a></li>
                <li><a href="../../index.html#contact">Contact</a></li>
            </ul>
        </nav>
    </header>
    
    <main>
        <article class="blog-post-content">
            <header class="post-header">
                <h1>üîí Secure Coding</h1>
            </header>

            <section class="post-content">
                <h2>üéØ Introduction to Secure Coding</h2>
                <div class="info-box">
                    <p>
                        <strong>Secure coding</strong> is the practice of developing computer software in a way that guards against the accidental introduction of security vulnerabilities. It involves following a set of rules and best practices that help eliminate the most common coding errors that lead to security breaches.
                    </p>
                    <ul>
                        <li><strong>Prevention over Remediation:</strong> It's cheaper and more effective to prevent vulnerabilities than to fix them later</li>
                        <li><strong>Defense in Depth:</strong> Multiple layers of security controls</li>
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions</li>
                        <li><strong>Input Validation:</strong> Never trust user input</li>
                        <li><strong>Secure by Default:</strong> Default configurations should be secure</li>
                    </ul>
                </div>

                <h2>üîê Secrets Management</h2>
                <div class="secrets-management">
                    <h3>üéØ Why Secrets Management Matters</h3>
                    <p>Hardcoded secrets in source code are one of the most common security vulnerabilities. API keys, passwords, tokens, and certificates must be properly managed to prevent unauthorized access.</p>
                    
                    <div style="margin-top: 2rem;">
                        <h4>üìä Common Secret Types:</h4>
                        <ul>
                            <li>API Keys and Tokens</li>
                            <li>Database Credentials</li>
                            <li>Encryption Keys</li>
                            <li>SSL/TLS Certificates</li>
                            <li>Service Account Credentials</li>
                            <li>Third-party Integration Keys</li>
                        </ul>
                    </div>
                </div>

                <h3>‚ùå Vulnerable Secrets Management</h3>
                <div class="comparison-grid">
                    <div class="comparison-section vulnerable-section">
                        <h5>üö® Bad Practice</h5>
                        <div class="code-block bad-practice">
                            <pre><code># ‚ùå NEVER DO THIS - Hardcoded secrets
import requests

class DatabaseConnector:
    def __init__(self):
        # Hardcoded credentials - MAJOR SECURITY RISK
        self.db_host = "prod-db.company.com"
        self.username = "admin"
        self.password = "SuperSecret123!"
        self.api_key = "sk-1234567890abcdef"
    
    def connect(self):
        connection_string = f"postgresql://{self.username}:{self.password}@{self.db_host}/mydb"
        return connection_string

# Hardcoded API key in source code
def call_external_api():
    headers = {
        'Authorization': 'Bearer sk-1234567890abcdef',
        'Content-Type': 'application/json'
    }
    return requests.get('https://api.example.com/data', headers=headers)

# Embedded encryption key
ENCRYPTION_KEY = "my-super-secret-key-2023"</code></pre>
                        </div>
                        <p><strong>Issues:</strong></p>
                        <ul>
                            <li>Secrets exposed in version control</li>
                            <li>No secret rotation capability</li>
                            <li>Hard to manage across environments</li>
                            <li>Exposed in logs and error messages</li>
                        </ul>
                    </div>
                    
                    <div class="comparison-section secure-section">
                        <h5>‚úÖ Secure Practice</h5>
                        <div class="code-block good-practice">
                            <pre><code># ‚úÖ SECURE - Environment variables and secrets management
import os
import boto3
from cryptography.fernet import Fernet
import logging

class SecureConnector:
    def __init__(self):
        # Load from environment variables
        self.db_host = os.getenv('DB_HOST')
        self.username = os.getenv('DB_USERNAME')
        self.password = self._get_secret('DB_PASSWORD')
        self.api_key = self._get_secret('API_KEY')
        
        if not all([self.db_host, self.username, self.password, self.api_key]):
            raise ValueError("Missing required environment variables")
    
    def _get_secret(self, secret_name):
        """Retrieve secret from AWS Secrets Manager"""
        try:
            client = boto3.client('secretsmanager')
            response = client.get_secret_value(SecretId=secret_name)
            return response['SecretString']
        except Exception as e:
            logging.error(f"Failed to retrieve secret: {secret_name}")
            raise
    
    def connect(self):
        # Use connection pooling and SSL
        connection_params = {
            'host': self.db_host,
            'username': self.username,
            'password': self.password,
            'sslmode': 'require'
        }
        return connection_params

# Secure API calling with proper error handling
def call_external_api():
    api_key = os.getenv('EXTERNAL_API_KEY')
    if not api_key:
        raise ValueError("API key not configured")
    
    headers = {
        'Authorization': f'Bearer {api_key}',
        'Content-Type': 'application/json'
    }
    
    try:
        response = requests.get('https://api.example.com/data', 
                              headers=headers, timeout=30)
        response.raise_for_status()
        return response.json()
    except requests.RequestException as e:
        logging.error("API call failed", exc_info=True)
        raise

# Dynamic key generation
def generate_encryption_key():
    """Generate a new encryption key"""
    return Fernet.generate_key()</code></pre>
                        </div>
                        <p><strong>Benefits:</strong></p>
                        <ul>
                            <li>Secrets stored securely outside code</li>
                            <li>Environment-specific configuration</li>
                            <li>Centralized secret management</li>
                            <li>Audit trails and rotation capabilities</li>
                        </ul>
                    </div>
                </div>

                <h3>üõ†Ô∏è Secrets Management Tools</h3>
                <div class="security-tools">
                    <div class="tool-card">
                        <h4>‚òÅÔ∏è Cloud-Based Solutions</h4>
                        <ul>
                            <li><strong>AWS Secrets Manager:</strong> Managed service with automatic rotation</li>
                            <li><strong>Azure Key Vault:</strong> Secure key and secret storage</li>
                            <li><strong>Google Secret Manager:</strong> Global secret management</li>
                            <li><strong>HashiCorp Vault:</strong> Multi-cloud secret management</li>
                        </ul>
                    </div>
                    
                    <div class="tool-card">
                        <h4>üîß Development Tools</h4>
                        <ul>
                            <li><strong>dotenv:</strong> Load environment variables from .env files</li>
                            <li><strong>git-secrets:</strong> Prevent committing secrets to git</li>
                            <li><strong>pre-commit hooks:</strong> Scan for secrets before commits</li>
                            <li><strong>Kubernetes Secrets:</strong> Native secret management in K8s</li>
                        </ul>
                    </div>
                    
                    <div class="tool-card">
                        <h4>üîç Detection Tools</h4>
                        <ul>
                            <li><strong>TruffleHog:</strong> Search for secrets in git repos</li>
                            <li><strong>GitLeaks:</strong> Detect and prevent secrets in git</li>
                            <li><strong>detect-secrets:</strong> Pre-commit hook for secret detection</li>
                            <li><strong>GitHub Secret Scanning:</strong> Built-in secret detection</li>
                        </ul>
                    </div>
                </div>

                <h2>‚ö†Ô∏è Error Handling and Information Disclosure</h2>
                <div class="warning-box">
                    <h4>üö® Information Disclosure Through Error Messages</h4>
                    <p>Poor error handling can expose sensitive information about your system architecture, database structure, file paths, and internal logic to attackers. This information can be used to plan more sophisticated attacks.</p>
                </div>

                <h3>üîç Secure Error Handling Patterns</h3>
                <div class="comparison-grid">
                    <div class="comparison-section vulnerable-section">
                        <h5>üö® Vulnerable Error Handling</h5>
                        <div class="code-block bad-practice">
                            <pre><code># ‚ùå BAD - Exposing sensitive information
import sqlite3
import traceback

def get_user_data(user_id):
    try:
        conn = sqlite3.connect('/var/www/app/database/users.db')
        cursor = conn.cursor()
        
        # SQL injection vulnerability + info disclosure
        query = f"SELECT * FROM users WHERE id = {user_id}"
        cursor.execute(query)
        
        result = cursor.fetchone()
        if not result:
            raise Exception(f"User {user_id} not found in database table 'users'")
        
        return result
        
    except sqlite3.Error as e:
        # Exposing database errors to client
        raise Exception(f"Database error: {str(e)}")
    except Exception as e:
        # Exposing full stack trace
        raise Exception(f"Internal error: {traceback.format_exc()}")

def authenticate_user(username, password):
    try:
        conn = sqlite3.connect('/home/admin/production.db')
        cursor = conn.cursor()
        
        # Vulnerable query with detailed error
        query = f"SELECT password_hash FROM users WHERE username = '{username}'"
        cursor.execute(query)
        
        result = cursor.fetchone()
        if not result:
            raise Exception(f"Username '{username}' does not exist in our system")
        
        stored_hash = result[0]
        if not check_password(password, stored_hash):
            raise Exception(f"Invalid password for user '{username}'. Password should be at least 8 characters.")
        
        return True
        
    except Exception as e:
        # Logging sensitive data
        print(f"Authentication failed for {username} with password {password}: {str(e)}")
        raise</code></pre>
                        </div>
                        <p><strong>Security Issues:</strong></p>
                        <ul>
                            <li>Database paths exposed in error messages</li>
                            <li>Stack traces reveal internal structure</li>
                            <li>SQL injection vulnerabilities</li>
                            <li>Username enumeration possible</li>
                            <li>Sensitive data logged in plaintext</li>
                        </ul>
                    </div>
                    
                    <div class="comparison-section secure-section">
                        <h5>‚úÖ Secure Error Handling</h5>
                        <div class="code-block good-practice">
                            <pre><code># ‚úÖ SECURE - Proper error handling and logging
import sqlite3
import logging
import hashlib
import secrets
from typing import Optional, Dict, Any

# Configure secure logging
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    handlers=[
        logging.FileHandler('/var/log/app/security.log'),
        logging.StreamHandler()
    ]
)

logger = logging.getLogger(__name__)

class SecurityError(Exception):
    """Custom exception for security-related errors"""
    pass

class DatabaseManager:
    def __init__(self, db_path: str):
        self.db_path = db_path
        self._setup_database()
    
    def _setup_database(self):
        """Initialize database with proper security settings"""
        try:
            with sqlite3.connect(self.db_path) as conn:
                conn.execute("PRAGMA foreign_keys = ON")
                conn.execute("PRAGMA secure_delete = ON")
        except sqlite3.Error as e:
            logger.error("Database initialization failed", exc_info=True)
            raise SecurityError("Database configuration error")

    def get_user_data(self, user_id: int) -> Optional[Dict[str, Any]]:
        """Retrieve user data with secure error handling"""
        try:
            with sqlite3.connect(self.db_path) as conn:
                conn.row_factory = sqlite3.Row
                cursor = conn.cursor()
                
                # Parameterized query prevents SQL injection
                cursor.execute("SELECT * FROM users WHERE id = ?", (user_id,))
                result = cursor.fetchone()
                
                if result:
                    return dict(result)
                else:
                    # Generic error message
                    logger.warning(f"User lookup failed for ID: {user_id}")
                    return None
                    
        except sqlite3.Error as e:
            # Log technical details internally
            logger.error(f"Database query failed for user_id {user_id}", exc_info=True)
            # Return generic error to client
            raise SecurityError("Data retrieval failed")
        except Exception as e:
            logger.error(f"Unexpected error in get_user_data", exc_info=True)
            raise SecurityError("Internal server error")

class AuthenticationManager:
    def __init__(self, db_manager: DatabaseManager):
        self.db_manager = db_manager
        self.max_attempts = 5
        self.lockout_duration = 300  # 5 minutes

    def authenticate_user(self, username: str, password: str) -> bool:
        """Secure user authentication with proper error handling"""
        # Input validation
        if not username or not password:
            logger.warning("Authentication attempt with empty credentials")
            raise SecurityError("Invalid credentials")
        
        if len(username) > 255 or len(password) > 255:
            logger.warning(f"Authentication attempt with oversized input from {username[:50]}...")
            raise SecurityError("Invalid credentials")
        
        try:
            # Check for account lockout
            if self._is_account_locked(username):
                logger.warning(f"Authentication attempt on locked account: {username}")
                raise SecurityError("Account temporarily locked")
            
            # Retrieve user data
            user_data = self._get_user_by_username(username)
            if not user_data:
                # Same error message for non-existent users (prevent enumeration)
                self._log_failed_attempt(username)
                raise SecurityError("Invalid credentials")
            
            # Verify password
            if self._verify_password(password, user_data['password_hash']):
                logger.info(f"Successful authentication for user: {username}")
                self._clear_failed_attempts(username)
                return True
            else:
                self._log_failed_attempt(username)
                raise SecurityError("Invalid credentials")
                
        except SecurityError:
            # Re-raise security errors as-is
            raise
        except Exception as e:
            # Log unexpected errors
            logger.error("Unexpected authentication error", exc_info=True)
            raise SecurityError("Authentication service unavailable")
    
    def _get_user_by_username(self, username: str) -> Optional[Dict[str, Any]]:
        """Retrieve user by username using parameterized query"""
        try:
            with sqlite3.connect(self.db_manager.db_path) as conn:
                conn.row_factory = sqlite3.Row
                cursor = conn.cursor()
                cursor.execute(
                    "SELECT id, username, password_hash FROM users WHERE username = ?", 
                    (username,)
                )
                result = cursor.fetchone()
                return dict(result) if result else None
        except sqlite3.Error as e:
            logger.error("Database query failed", exc_info=True)
            return None
    
    def _verify_password(self, password: str, stored_hash: str) -> bool:
        """Secure password verification"""
        try:
            # Use secure comparison to prevent timing attacks
            return secrets.compare_digest(
                hashlib.pbkdf2_hmac('sha256', password.encode(), b'salt', 100000),
                bytes.fromhex(stored_hash)
            )
        except Exception as e:
            logger.error("Password verification error", exc_info=True)
            return False
    
    def _log_failed_attempt(self, username: str):
        """Log failed authentication attempt"""
        # Log without exposing password
        logger.warning(f"Failed authentication attempt for username: {username}")
    
    def _is_account_locked(self, username: str) -> bool:
        """Check if account is locked due to failed attempts"""
        # Implementation would check failed attempt count and timing
        return False
    
    def _clear_failed_attempts(self, username: str):
        """Clear failed attempt counter after successful login"""
        pass

# Usage example
def main():
    try:
        db_manager = DatabaseManager("/secure/path/app.db")
        auth_manager = AuthenticationManager(db_manager)
        
        result = auth_manager.authenticate_user("john_doe", "secure_password")
        if result:
            print("Authentication successful")
        
    except SecurityError as e:
        # Return generic error to client
        print(f"Error: {str(e)}")
    except Exception as e:
        # Log unexpected errors, return generic message
        logger.error("Unexpected application error", exc_info=True)
        print("Service temporarily unavailable")</code></pre>
                        </div>
                        <p><strong>Security Benefits:</strong></p>
                        <ul>
                            <li>Generic error messages prevent information disclosure</li>
                            <li>Parameterized queries prevent SQL injection</li>
                            <li>Detailed logging for security monitoring</li>
                            <li>Rate limiting and account lockout protection</li>
                            <li>Secure password comparison prevents timing attacks</li>
                        </ul>
                    </div>
                </div>

                <h2>üõ°Ô∏è Common Vulnerability Prevention</h2>
                <div class="danger-box">
                    <h4>‚ö†Ô∏è OWASP Top 10 - Most Critical Security Risks</h4>
                    <p>The OWASP Top 10 represents the most critical security risks to web applications. Understanding and preventing these vulnerabilities is essential for secure coding.</p>
                </div>

                <div class="owasp-top10">
                    <div class="owasp-item">
                        <h4>1. Injection</h4>
                        <p><strong>Risk:</strong> SQL, NoSQL, OS, and LDAP injection</p>
                        <p><strong>Prevention:</strong> Use parameterized queries, input validation, and ORM frameworks</p>
                    </div>
                    
                    <div class="owasp-item">
                        <h4>2. Broken Authentication</h4>
                        <p><strong>Risk:</strong> Session management flaws, weak passwords</p>
                        <p><strong>Prevention:</strong> Implement MFA, secure session management, strong password policies</p>
                    </div>
                    
                    <div class="owasp-item">
                        <h4>3. Sensitive Data Exposure</h4>
                        <p><strong>Risk:</strong> Unencrypted data transmission and storage</p>
                        <p><strong>Prevention:</strong> Encrypt data at rest and in transit, use HTTPS everywhere</p>
                    </div>
                    
                    <div class="owasp-item">
                        <h4>4. XML External Entities (XXE)</h4>
                        <p><strong>Risk:</strong> XML processors with external entity references</p>
                        <p><strong>Prevention:</strong> Disable XML external entities, use secure XML parsers</p>
                    </div>
                    
                    <div class="owasp-item">
                        <h4>5. Broken Access Control</h4>
                        <p><strong>Risk:</strong> Unauthorized access to functionality and data</p>
                        <p><strong>Prevention:</strong> Implement proper authorization checks, principle of least privilege</p>
                    </div>
                    
                    <div class="owasp-item">
                        <h4>6. Security Misconfiguration</h4>
                        <p><strong>Risk:</strong> Default configurations, incomplete setups</p>
                        <p><strong>Prevention:</strong> Security hardening, regular security reviews, automated deployment</p>
                    </div>
                </div>

                <h2>üß™ Interactive Security Testing</h2>
                <div class="interactive-demo">
                    <h4>üî¨ Security Vulnerability Demonstrations</h4>
                    <p>Practice identifying and fixing common security vulnerabilities:</p>
                    
                    <div class="demo-tabs">
                        <button class="tab-button active" onclick="showTab('sql-injection')">SQL Injection</button>
                        <button class="tab-button" onclick="showTab('xss-prevention')">XSS Prevention</button>
                        <button class="tab-button" onclick="showTab('input-validation')">Input Validation</button>
                        <button class="tab-button" onclick="showTab('secure-auth')">Secure Authentication</button>
                    </div>
                    
                    <!-- SQL Injection Tab -->
                    <div id="sql-injection" class="tab-content active">
                        <h5>üíâ SQL Injection Prevention</h5>
                        <p>Learn how to prevent SQL injection attacks using parameterized queries:</p>
                        <div class="code-editor" id="sqlEditor"></div>
                        <button class="run-button" onclick="runSQLDemo()">Test SQL Security</button>
                        <div class="output" id="sqlOutput">SQL injection test results will appear here...</div>
                    </div>
                    
                    <!-- XSS Prevention Tab -->
                    <div id="xss-prevention" class="tab-content">
                        <h5>üîí Cross-Site Scripting (XSS) Prevention</h5>
                        <p>Demonstrate XSS vulnerabilities and prevention techniques:</p>
                        <div class="code-editor" id="xssEditor"></div>
                        <button class="run-button" onclick="runXSSDemo()">Test XSS Protection</button>
                        <div class="output" id="xssOutput">XSS prevention test results will appear here...</div>
                    </div>
                    
                    <!-- Input Validation Tab -->
                    <div id="input-validation" class="tab-content">
                        <h5>‚úÖ Input Validation & Sanitization</h5>
                        <p>Implement comprehensive input validation and sanitization:</p>
                        <div class="code-editor" id="validationEditor"></div>
                        <button class="run-button" onclick="runValidationDemo()">Test Input Validation</button>
                        <div class="output" id="validationOutput">Input validation test results will appear here...</div>
                    </div>
                    
                    <!-- Secure Authentication Tab -->
                    <div id="secure-auth" class="tab-content">
                        <h5>üõ°Ô∏è Secure Authentication Implementation</h5>
                        <p>Build secure authentication with proper password handling:</p>
                        <div class="code-editor" id="authEditor"></div>
                        <button class="run-button" onclick="runAuthDemo()">Test Authentication Security</button>
                        <div class="output" id="authOutput">Authentication security test results will appear here...</div>
                    </div>
                </div>

                <h2>üîê Cryptography Best Practices</h2>
                <div class="info-box">
                    <h4>üõ°Ô∏è Cryptographic Guidelines</h4>
                    <ul>
                        <li><strong>Use Strong Algorithms:</strong> AES-256, RSA-2048+, SHA-256+</li>
                        <li><strong>Proper Key Management:</strong> Generate, store, and rotate keys securely</li>
                        <li><strong>Salt Passwords:</strong> Use unique salts for each password hash</li>
                        <li><strong>Secure Random Numbers:</strong> Use cryptographically secure random generators</li>
                        <li><strong>Perfect Forward Secrecy:</strong> Ensure past communications remain secure</li>
                    </ul>
                </div>

                <h3>üîë Secure Password Handling</h3>
                <div class="code-block good-practice">
                    <pre><code># ‚úÖ SECURE - Proper password hashing and verification
import bcrypt
import secrets
import hashlib
from typing import Tuple

class SecurePasswordManager:
    def __init__(self):
        self.min_length = 12
        self.max_length = 128
        
    def hash_password(self, password: str) -> str:
        """Hash password using bcrypt with salt"""
        if not self._validate_password_strength(password):
            raise ValueError("Password does not meet security requirements")
        
        # Generate salt and hash password
        salt = bcrypt.gensalt(rounds=12)  # Adjust rounds based on performance needs
        hashed = bcrypt.hashpw(password.encode('utf-8'), salt)
        return hashed.decode('utf-8')
    
    def verify_password(self, password: str, hashed: str) -> bool:
        """Verify password against hash using constant-time comparison"""
        try:
            return bcrypt.checkpw(password.encode('utf-8'), hashed.encode('utf-8'))
        except Exception:
            return False
    
    def _validate_password_strength(self, password: str) -> bool:
        """Validate password meets security requirements"""
        if len(password) < self.min_length or len(password) > self.max_length:
            return False
        
        has_upper = any(c.isupper() for c in password)
        has_lower = any(c.islower() for c in password)
        has_digit = any(c.isdigit() for c in password)
        has_special = any(c in "!@#$%^&*()_+-=[]{}|;:,.<>?" for c in password)
        
        return all([has_upper, has_lower, has_digit, has_special])
    
    def generate_secure_token(self, length: int = 32) -> str:
        """Generate cryptographically secure random token"""
        return secrets.token_urlsafe(length)
    
    def generate_api_key(self) -> Tuple[str, str]:
        """Generate API key pair (public ID and secret key)"""
        key_id = f"ak_{secrets.token_urlsafe(16)}"
        secret_key = secrets.token_urlsafe(32)
        
        # Hash the secret key for storage
        secret_hash = hashlib.sha256(secret_key.encode()).hexdigest()
        
        return key_id, secret_key, secret_hash

# Example usage
password_manager = SecurePasswordManager()

# Hash a password
password = "MySecureP@ssw0rd123!"
hashed_password = password_manager.hash_password(password)
print(f"Hashed password: {hashed_password}")

# Verify password
is_valid = password_manager.verify_password(password, hashed_password)
print(f"Password verification: {is_valid}")

# Generate secure tokens
token = password_manager.generate_secure_token()
print(f"Secure token: {token}")

# Generate API key
key_id, secret, secret_hash = password_manager.generate_api_key()
print(f"API Key ID: {key_id}")
print(f"Secret Key: {secret}")
print(f"Secret Hash: {secret_hash}")
</code></pre>
                </div>

                <h2>üìã Secure Coding Checklist</h2>
                <div class="checklist">
                    <h4>üõ°Ô∏è Pre-Development Security Checklist</h4>
                    <ul>
                        <li>‚úÖ <strong>Threat Modeling:</strong> Identify potential threats and attack vectors</li>
                        <li>‚úÖ <strong>Security Requirements:</strong> Define security requirements early</li>
                        <li>‚úÖ <strong>Secure Architecture:</strong> Design with security principles in mind</li>
                        <li>‚úÖ <strong>Technology Selection:</strong> Choose secure frameworks and libraries</li>
                    </ul>
                    
                    <h4>üîß Development Security Checklist</h4>
                    <ul>
                        <li>‚úÖ <strong>Input Validation:</strong> Validate all input data</li>
                        <li>‚úÖ <strong>Output Encoding:</strong> Encode output to prevent XSS</li>
                        <li>‚úÖ <strong>Parameterized Queries:</strong> Prevent SQL injection</li>
                        <li>‚úÖ <strong>Authentication:</strong> Implement strong authentication mechanisms</li>
                        <li>‚úÖ <strong>Authorization:</strong> Enforce proper access controls</li>
                        <li>‚úÖ <strong>Session Management:</strong> Secure session handling</li>
                        <li>‚úÖ <strong>Cryptography:</strong> Use strong encryption and hashing</li>
                        <li>‚úÖ <strong>Error Handling:</strong> Implement secure error handling</li>
                        <li>‚úÖ <strong>Logging:</strong> Log security events appropriately</li>
                        <li>‚úÖ <strong>Configuration:</strong> Secure default configurations</li>
                    </ul>
                    
                    <h4>üîç Testing Security Checklist</h4>
                    <ul>
                        <li>‚úÖ <strong>Static Code Analysis:</strong> Use SAST tools to find vulnerabilities</li>
                        <li>‚úÖ <strong>Dynamic Testing:</strong> Perform DAST on running applications</li>
                        <li>‚úÖ <strong>Dependency Scanning:</strong> Check for vulnerable dependencies</li>
                        <li>‚úÖ <strong>Penetration Testing:</strong> Professional security testing</li>
                        <li>‚úÖ <strong>Code Review:</strong> Security-focused code reviews</li>
                    </ul>
                    
                    <h4>üöÄ Deployment Security Checklist</h4>
                    <ul>
                        <li>‚úÖ <strong>Secrets Management:</strong> No hardcoded secrets in production</li>
                        <li>‚úÖ <strong>HTTPS Everywhere:</strong> Encrypt all communications</li>
                        <li>‚úÖ <strong>Security Headers:</strong> Implement security HTTP headers</li>
                        <li>‚úÖ <strong>Monitoring:</strong> Set up security monitoring and alerting</li>
                        <li>‚úÖ <strong>Backup & Recovery:</strong> Secure backup and disaster recovery</li>
                        <li>‚úÖ <strong>Update Management:</strong> Keep all components updated</li>
                    </ul>
                </div>

                <h2>üõ†Ô∏è Security Tools and Frameworks</h2>
                <div class="security-tools">
                    <div class="tool-card">
                        <h4>üîç Static Analysis (SAST)</h4>
                        <ul>
                            <li><strong>SonarQube:</strong> Code quality and security analysis</li>
                            <li><strong>Checkmarx:</strong> Static application security testing</li>
                            <li><strong>Veracode:</strong> Application security platform</li>
                            <li><strong>Bandit:</strong> Python security linter</li>
                            <li><strong>ESLint Security:</strong> JavaScript security rules</li>
                        </ul>
                    </div>
                    
                    <div class="tool-card">
                        <h4>üéØ Dynamic Analysis (DAST)</h4>
                        <ul>
                            <li><strong>OWASP ZAP:</strong> Web application security scanner</li>
                            <li><strong>Burp Suite:</strong> Web vulnerability scanner</li>
                            <li><strong>Nessus:</strong> Vulnerability assessment tool</li>
                            <li><strong>Acunetix:</strong> Web application security scanner</li>
                        </ul>
                    </div>
                    
                    <div class="tool-card">
                        <h4>üì¶ Dependency Scanning</h4>
                        <ul>
                            <li><strong>Snyk:</strong> Find and fix vulnerabilities in dependencies</li>
                            <li><strong>npm audit:</strong> Built-in Node.js security auditing</li>
                            <li><strong>OWASP Dependency-Check:</strong> Identify known vulnerabilities</li>
                            <li><strong>GitHub Dependabot:</strong> Automated dependency updates</li>
                        </ul>
                    </div>
                    
                    <div class="tool-card">
                        <h4>üîê Security Frameworks</h4>
                        <ul>
                            <li><strong>OWASP ASVS:</strong> Application Security Verification Standard</li>
                            <li><strong>NIST Cybersecurity Framework:</strong> Comprehensive security guidance</li>
                            <li><strong>ISO 27001:</strong> Information security management</li>
                            <li><strong>SANS Top 25:</strong> Most dangerous software errors</li>
                        </ul>
                    </div>
                </div>

                <h2>üéØ Security in CI/CD Pipeline</h2>
                <div class="success-box">
                    <h4>DevSecOps - Security as Code</h4>
                    <p>Integrate security throughout the development lifecycle with automated security testing and continuous monitoring.</p>
                </div>

                <div class="code-block">
                    <pre><code># Example GitHub Actions workflow for security
name: Security Pipeline

on: [push, pull_request]

jobs:
  security-scan:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    # Secret scanning
    - name: Secret Scan
      uses: trufflesecurity/trufflehog@main
      with:
        path: ./
        base: main
        head: HEAD
    
    # Static Application Security Testing (SAST)
    - name: Run Bandit Security Linter
      uses: jpetrucciani/bandit-check@main
      with:
        path: "."
    
    # Dependency vulnerability scanning
    - name: Python Security Check
      uses: pyupio/safety@2.3.1
      with:
        api-key: ${{ secrets.SAFETY_API_KEY }}
    
    # Dynamic Application Security Testing (DAST)
    - name: ZAP Scan
      uses: zaproxy/action-full-scan@v0.4.0
      with:
        target: 'https://your-app.com'
        rules_file_name: '.zap/rules.tsv'
        cmd_options: '-a'
    
    # Infrastructure as Code security
    - name: Checkov Security Scan
      uses: bridgecrewio/checkov-action@v12
      with:
        directory: ./terraform
        framework: terraform
        output_format: sarif
        output_file_path: checkov.sarif
    
    # Upload results to GitHub Security tab
    - name: Upload SARIF file
      uses: github/codeql-action/upload-sarif@v2
      with:
        sarif_file: checkov.sarif</code></pre>
                </div>

                <h2>üìö Conclusion</h2>
                <p>
                    Secure coding is not just about following a checklist‚Äîit's about developing a security mindset and making security an integral part of your development process. The key principles include:
                </p>
                
                <div class="info-box">
                    <h4>üéØ Key Takeaways</h4>
                    <ul>
                        <li><strong>Defense in Depth:</strong> Implement multiple layers of security controls</li>
                        <li><strong>Secure by Default:</strong> Make secure configuration the default</li>
                        <li><strong>Principle of Least Privilege:</strong> Grant minimum necessary permissions</li>
                        <li><strong>Input Validation:</strong> Never trust user input</li>
                        <li><strong>Fail Securely:</strong> Ensure failures don't compromise security</li>
                        <li><strong>Keep it Simple:</strong> Complex systems are harder to secure</li>
                        <li><strong>Stay Updated:</strong> Keep dependencies and frameworks current</li>
                        <li><strong>Security Testing:</strong> Test security throughout the development lifecycle</li>
                    </ul>
                </div>

                <p>
                    Security is everyone's responsibility, and by following these practices, you'll be well-equipped to build more secure applications and protect against common vulnerabilities.
                </p>
            </section>
            
            <footer class="post-footer">
                <div class="post-nav">
                    <a href="../../blog.html" class="back-to-blog">‚Üê Back to Blog</a>
                </div>
            </footer>
        </article>
    </main>
    
    <footer>
        <p>&copy; 2025 Deepak Kumar Yadav | <a href="../../index.html">Back to Home</a></p>
    </footer>