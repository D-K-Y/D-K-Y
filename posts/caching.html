<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Ultimate Guide to Caching in Python</title>
    <link rel="stylesheet" href="../css/styles.css">
    <style>
        .blog-post-content {
            max-width: 900px;
            margin: 2rem auto;
            padding: 2rem;
            background: var(--background, #f8f9fa);
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            color: #333;
        }
        .blog-post-content h1, 
        .blog-post-content h2, 
        .blog-post-content h3 {
            color: #2c3e50;
        }
        .blog-post-content code {
            background-color: #f4f4f4;
            border-radius: 4px;
            padding: 0.2em 0.4em;
            font-size: 0.98em;
        }
        .blog-post-content pre {
            background-color: #f4f4f4;
            border-left: 4px solid #3498db;
            padding: 1em;
            display: block;
            overflow-x: auto;
            border-radius: 4px;
            margin: 1rem 0;
        }
        .diagram {
            text-align: center;
            margin: 2rem 0;
        }
        
        .cache-diagram {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 2px solid #dee2e6;
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
        }
        
        .diagram-title {
            text-align: center;
            font-weight: bold;
            margin-bottom: 2rem;
            font-size: 1.3rem;
            color: #2c3e50;
        }
        
        .diagram-flow {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 2rem 0;
            flex-wrap: wrap;
            gap: 1.5rem;
        }
        
        .diagram-box {
            padding: 1.2rem 1rem;
            border-radius: 8px;
            min-width: 90px;
            text-align: center;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
            border: 2px solid;
            font-weight: 500;
            position: relative;
        }
        
        .diagram-box:hover {
            transform: translateY(-2px);
        }
        
        .client-box { 
            background: #e3f2fd;
            color: #1565c0;
            border-color: #90caf9;
        }
        
        .app-box { 
            background: #f3e5f5;
            color: #7b1fa2;
            border-color: #ce93d8;
        }
        
        .cache-box { 
            background: #e0f2f1;
            color: #00695c;
            border-color: #80cbc4;
        }
        
        .db-box { 
            background: #fff3e0;
            color: #ef6c00;
            border-color: #ffcc02;
        }
        
        .flow-arrow {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 0.5rem;
        }
        
        .arrow-line {
            font-size: 1.8rem;
            color: #6c757d;
            font-weight: bold;
        }
        
        .arrow-label {
            font-size: 0.75rem;
            color: #6c757d;
            margin-top: 0.2rem;
            font-weight: 500;
        }
        
        .request-flow {
            display: grid;
            grid-template-columns: 1fr auto 1fr auto 1fr;
            gap: 1rem;
            align-items: center;
            margin: 2rem 0;
            padding: 1.5rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .flow-info {
            margin-top: 2rem;
            padding: 1.5rem;
            background: #ffffff;
            border-left: 4px solid #28a745;
            border-radius: 0 6px 6px 0;
            font-size: 0.95rem;
            text-align: left;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .flow-step {
            display: flex;
            align-items: center;
            margin: 0.6rem 0;
            padding: 0.8rem;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #28a745;
        }
        
        .step-number {
            background: #28a745;
            color: white;
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .cache-hit {
            border-left-color: #28a745;
        }
        
        .cache-miss {
            border-left-color: #ffc107;
        }
        
        .cache-hit .step-number {
            background: #28a745;
        }
        
        .cache-miss .step-number {
            background: #ffc107;
        }
        
        .pattern-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        .pattern-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #007bff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .pattern-card h4 {
            margin-top: 0;
            color: #007bff;
        }
        
        .pros-cons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin: 1rem 0;
        }
        
        .pros-list {
            background: #d4edda;
            padding: 1rem;
            border-radius: 6px;
            border-left: 3px solid #28a745;
        }
        
        .cons-list {
            background: #f8d7da;
            padding: 1rem;
            border-radius: 6px;
            border-left: 3px solid #dc3545;
        }
        
        h3 {
            color: #2c3e50;
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e9ecef;
        }
        
        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }
        
        @media (max-width: 768px) {
            .diagram-flow {
                flex-direction: column;
                gap: 1rem;
            }
            
            .flow-arrow {
                transform: rotate(90deg);
                margin: 0.5rem 0;
            }
            
            .request-flow {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
            
            .cache-diagram {
                padding: 1rem;
            }
            
            .diagram-box {
                min-width: 80px;
                padding: 1rem 0.5rem;
            }
            
            .pros-cons-grid {
                grid-template-columns: 1fr;
            }
            
            .pattern-comparison {
                grid-template-columns: 1fr;
            }
            
            .pattern-grid {
                grid-template-columns: 1fr;
            }
        }
        
        ul {
            margin: 1rem 0 1rem 1.5rem;
        }
        li {
            margin-bottom: 0.5rem;
        }
        @media (max-width: 700px) {
            .blog-post-content {
                padding: 1rem;
            }
            .diagram img {
                width: 100% !important;
                height: auto;
            }
        }
        
        .tag {
            background-color: #e7f3ff;
            padding: 0.2rem 0.5rem;
            font-size: 0.85rem;
            border-radius: 5px;
            margin-right: 0.3rem;
            color: #0366d6;
            display: inline-block;
            margin-bottom: 0.3rem;
        }

        /* Remove these 4 CSS rule blocks */


    </style>
</head>
<body>
    <header>
        <nav>
            <div class="nav-brand">
                <span class="avatar">DKY</span>
                <span class="brand-name">Deepak Kumar Yadav</span>
            </div>
            <ul>
                <li><a href="../index.html">Home</a></li>
                <li><a href="../blog.html">My Blog</a></li>
            </ul>
            <button id="theme-toggle" aria-label="Toggle dark mode">üåô</button>
        </nav>
    </header>
    <main>
        <article class="blog-post-content">

            <!-- THEN CONTINUE WITH YOUR MAIN BLOG CONTENT -->
            <h1>üöÄ Ultimate Guide to Caching in Python</h1>
            <p>Caching is essential for optimizing performance and scalability in Python applications. In this guide, we explore caching architectures, eviction strategies, and real Python implementations using in-memory and distributed caches like Redis.</p>
            
            <h2>üß± Caching Architecture</h2>
            <div class="diagram">
                <div class="cache-diagram">
                    <div class="diagram-title">üèóÔ∏è Cache-Aside Pattern Flow</div>
                    
                    <!-- Unified Flow -->
                    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; border: 2px solid #dee2e6;">
                        
                        <!-- Initial Request -->
                        <div class="request-flow" style="grid-template-columns: 1fr auto 1fr auto 1fr;">
                            <div class="diagram-box client-box">
                                <div style="font-size: 1.5rem;">üì±</div>
                                <strong>Client</strong>
                            </div>
                            
                            <div class="flow-arrow">
                                <div class="arrow-line">‚Üí</div>
                                <div class="arrow-label">HTTP Request</div>
                            </div>
                            
                            <div class="diagram-box app-box">
                                <div style="font-size: 1.5rem;">‚öôÔ∏è</div>
                                <strong>App</strong>
                            </div>
                            
                            <div class="flow-arrow">
                                <div class="arrow-line">‚Üí</div>
                                <div class="arrow-label">Check Cache</div>
                            </div>
                            
                            <div class="diagram-box cache-box">
                                <div style="font-size: 1.5rem;">üóÑÔ∏è</div>
                                <strong>Redis</strong>
                            </div>
                        </div>
                        
                        <!-- Decision Point -->
                        <div style="text-align: center; margin: 1.5rem 0; padding: 1rem; background: #fff3cd; border-radius: 6px;">
                            <strong>üö¶ Cache Hit or Miss?</strong>
                        </div>
                        
                        <!-- Two Paths -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem;">
                            
                            <!-- Cache HIT -->
                            <div style="background: #d4edda; padding: 1rem; border-radius: 6px; border-left: 4px solid #28a745;">
                                <h4 style="color: #28a745; margin: 0 0 1rem 0; text-align: center;">‚úÖ HIT (~1ms)</h4>
                                <div style="text-align: center; font-size: 0.9rem;">
                                    Cache ‚Üí App ‚Üí Client<br>
                                    <strong>Fast Response</strong><br>
                                    No DB Load
                                </div>
                            </div>
                            
                            <!-- Cache MISS -->
                            <div style="background: #fff3cd; padding: 1rem; border-radius: 6px; border-left: 4px solid #ffc107;">
                                <h4 style="color: #856404; margin: 0 0 1rem 0; text-align: center;">‚ö†Ô∏è MISS (~50ms)</h4>
                                <div style="text-align: center; font-size: 0.9rem;">
                                    App ‚Üí DB ‚Üí Cache ‚Üí Client<br>
                                    <strong>Slower Response</strong><br>
                                    Full DB Query
                                </div>
                            </div>
                        </div>
                        
                        <!-- Key Points -->
                        <div style="margin-top: 1.5rem; padding: 1rem; background: #e3f2fd; border-radius: 6px; text-align: center;">
                            <strong>üéØ Goal:</strong> 80-95% cache hit rate<br>
                            <strong>üìà Impact:</strong> 20-50x faster responses on hits
                        </div>
                    </div>
                </div>
                
                <p style="text-align: center; font-style: italic; color: #666; margin-top: 1rem;">
                    <strong>Cache-Aside:</strong> App manages cache reads/writes explicitly
                </p>
            </div>
            
            <h2>üèóÔ∏è Complete Guide to Caching Patterns</h2>
            <p>Understanding different caching patterns is crucial for choosing the right strategy for your application. Each pattern has specific use cases, benefits, and trade-offs.</p>

            <!-- Cache-Aside Pattern Details -->
            <h3>1Ô∏è‚É£ Cache-Aside (Lazy Loading) Pattern</h3>
            <div class="cache-diagram">
                <div class="request-flow">
                    <div class="diagram-box app-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üì±</div>
                        <strong>Application</strong><br>
                        <small>Manages Cache</small>
                    </div>
                    
                    <div class="flow-arrow">
                        <div class="arrow-line">‚Üï</div>
                        <div class="arrow-label">1. Check</div>
                    </div>
                    
                    <div class="diagram-box cache-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÑÔ∏è</div>
                        <strong>Cache</strong><br>
                        <small>Hit/Miss</small>
                    </div>
                    
                    <div class="flow-arrow">
                        <div class="arrow-line">‚Üï</div>
                        <div class="arrow-label">2. If Miss</div>
                    </div>
                    
                    <div class="diagram-box db-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÉÔ∏è</div>
                        <strong>Database</strong><br>
                        <small>Fetch Data</small>
                    </div>
                </div>
                
                <div class="flow-info">
                    <strong>üìã How it works:</strong>
                    <ul>
                        <li>Application checks cache first</li>
                        <li>On cache miss, fetches from database</li>
                        <li>Application stores result in cache</li>
                        <li>Subsequent requests served from cache</li>
                    </ul>
                    <p><strong>‚úÖ Best for:</strong> Read-heavy workloads, unpredictable access patterns<br>
                    <strong>‚ùå Challenges:</strong> Cache warming, potential stale data, initial latency</p>
                </div>
            </div>

            <!-- Write-Through Pattern -->
            <h3>2Ô∏è‚É£ Write-Through Pattern</h3>
            <div class="cache-diagram">
                <div class="request-flow">
                    <div class="diagram-box client-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üì±</div>
                        <strong>Application</strong><br>
                        <small>Write Request</small>
                    </div>
                    
                    <div class="flow-arrow">
                        <div class="arrow-line">‚Üí</div>
                        <div class="arrow-label">1. Write</div>
                    </div>
                    
                    <div class="diagram-box cache-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÑÔ∏è</div>
                        <strong>Cache</strong><br>
                        <small>Store Data</small>
                    </div>
                    
                    <div class="flow-arrow">
                        <div class="arrow-line">‚Üí</div>
                        <div class="arrow-label">2. Sync Write</div>
                    </div>
                    
                    <div class="diagram-box db-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÉÔ∏è</div>
                        <strong>Database</strong><br>
                        <small>Persist Data</small>
                    </div>
                </div>
                
                <div class="flow-info">
                    <strong>üìã How it works:</strong>
                    <ul>
                        <li>Write to cache and database simultaneously</li>
                        <li>Cache always consistent with database</li>
                        <li>Reads are fast (always cache hits)</li>
                        <li>Write operation completes only after both succeed</li>
                    </ul>
                    <p><strong>‚úÖ Best for:</strong> Strong consistency requirements, read-heavy after writes<br>
                    <strong>‚ùå Challenges:</strong> Higher write latency, unnecessary cache entries</p>
                </div>
            </div>

            <!-- Write-Behind Pattern -->
            <h3>3Ô∏è‚É£ Write-Behind (Write-Back) Pattern</h3>
            <div class="cache-diagram">
                <div class="request-flow">
                    <div class="diagram-box client-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üì±</div>
                        <strong>Application</strong><br>
                        <small>Write Request</small>
                    </div>
                    
                    <div class="flow-arrow">
                        <div class="arrow-line">‚Üí</div>
                        <div class="arrow-label">1. Fast Write</div>
                    </div>
                    
                    <div class="diagram-box cache-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÑÔ∏è</div>
                        <strong>Cache</strong><br>
                        <small>Store Immediately</small>
                    </div>
                </div>
                
                <div style="text-align: center; margin: 1rem 0; font-size: 1.1rem; color: #6c757d;">
                    ‚è∞ Async After Delay ‚è∞
                </div>
                
                <div class="request-flow">
                    <div class="diagram-box cache-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÑÔ∏è</div>
                        <strong>Cache</strong><br>
                        <small>Background Process</small>
                    </div>
                    
                    <div class="flow-arrow">
                        <div class="arrow-line">‚Üí</div>
                        <div class="arrow-label">Batch Write</div>
                    </div>
                    
                    <div class="diagram-box db-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÉÔ∏è</div>
                        <strong>Database</strong><br>
                        <small>Batch Updates</small>
                    </div>
                </div>
                
                <div class="flow-info">
                    <strong>üìã How it works:</strong>
                    <ul>
                        <li>Write to cache immediately, return success</li>
                        <li>Database updated asynchronously later</li>
                        <li>Can batch multiple writes for efficiency</li>
                        <li>Excellent write performance</li>
                    </ul>
                    <p><strong>‚úÖ Best for:</strong> Write-heavy workloads, high performance requirements<br>
                    <strong>‚ùå Challenges:</strong> Data loss risk, complex consistency, cache/DB drift</p>
                </div>
            </div>

            <!-- Write-Around Pattern -->
            <h3>4Ô∏è‚É£ Write-Around Pattern</h3>
            <div class="cache-diagram">
                <div class="request-flow">
                    <div class="diagram-box client-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üì±</div>
                        <strong>Application</strong><br>
                        <small>Write Request</small>
                    </div>
                    
                    <div class="flow-arrow">
                        <div class="arrow-line">‚Üí</div>
                        <div class="arrow-label">Direct Write</div>
                    </div>
                    
                    <div class="diagram-box db-box">
                        <div style="font-size: 1.8rem; margin-bottom: 0.3rem;">üóÉÔ∏è</div>
                        <strong>Database</strong><br>
                        <small>Store Data</small>
                    </div>
                </div>
                
                <div style="text-align: center; margin: 1rem 0; font-size: 1.1rem; color: #6c757d;">
                    üìñ Read Requests Use Cache-Aside
                </div>
                
                <div class="flow-info">
                    <strong>üìã How it works:</strong>
                    <ul>
                        <li>Writes bypass cache, go directly to database</li>
                        <li>Reads use cache-aside pattern</li>
                        <li>Cache populated only on read requests</li>
                        <li>Prevents cache pollution from rarely-read data</li>
                    </ul>
                    <p><strong>‚úÖ Best for:</strong> Write-heavy workloads, infrequently read data<br>
                    <strong>‚ùå Challenges:</strong> Cache misses after writes, potential inconsistency window</p>
                </div>
            </div>

            <h2>üéØ Pattern Selection Guide</h2>
            <div style="background: #f8f9fa; padding: 2rem; border-radius: 8px; margin: 2rem 0;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem;">
                    
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #28a745;">
                        <h4 style="color: #28a745; margin-top: 0;">üìñ Read-Heavy Applications</h4>
                        <p><strong>Best Choice:</strong> Cache-Aside</p>
                        <p><strong>Examples:</strong> News sites, product catalogs, user profiles</p>
                    </div>
                    
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #007bff;">
                        <h4 style="color: #007bff; margin-top: 0;">‚úçÔ∏è Write-Heavy Applications</h4>
                        <p><strong>Best Choice:</strong> Write-Behind or Write-Around</p>
                        <p><strong>Examples:</strong> Logging systems, analytics, IoT data</p>
                    </div>
                    
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #6f42c1;">
                        <h4 style="color: #6f42c1; margin-top: 0;">üîí Strong Consistency</h4>
                        <p><strong>Best Choice:</strong> Write-Through</p>
                        <p><strong>Examples:</strong> Financial systems, inventory, user settings</p>
                    </div>
                    
                    <div style="background: white; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #dc3545;">
                        <h4 style="color: #dc3545; margin-top: 0;">‚ö° High Performance</h4>
                        <p><strong>Best Choice:</strong> Write-Behind + Cache-Aside</p>
                        <p><strong>Examples:</strong> Gaming leaderboards, real-time feeds</p>
                    </div>
                    
                </div>
            </div>

            <h2>üîÑ Example: E-commerce Platform</h2>
            <div class="flow-info">
                <h4>üè™ How different patterns work together:</h4>
                <ul>
                    <li><strong>Product Catalog:</strong> Cache-Aside (read-heavy, occasional updates)</li>
                    <li><strong>User Sessions:</strong> Write-Through (consistency important)</li>
                    <li><strong>Analytics Events:</strong> Write-Behind (high volume, eventual consistency OK)</li>
                    <li><strong>Price Updates:</strong> Write-Around (frequent writes, infrequent reads)</li>
                </ul>
            </div>

<            <h2>üèÉ‚Äç‚ôÇÔ∏è Demo</h2>

            <!-- Interactive Demo Controls -->
            <div style="background: #e3f2fd; padding: 2rem; border-radius: 8px; border-left: 4px solid #2196f3; margin: 2rem 0;">
                <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center; margin-bottom: 1rem;">
                    <button id="runDemo" style="background: #28a745; color: white; border: none; padding: 0.8rem 1.5rem; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 1rem;">
                        üöÄ Run Caching Demo
                    </button>
                    <button id="clearOutput" style="background: #6c757d; color: white; border: none; padding: 0.8rem 1rem; border-radius: 6px; cursor: pointer;">
                        üóëÔ∏è Clear Output
                    </button>
                    <button id="runCustomTest" style="background: #007bff; color: white; border: none; padding: 0.8rem 1rem; border-radius: 6px; cursor: pointer;">
                        üß™ Run Custom Test
                    </button>
                </div>
                
                <!-- Custom Test Controls -->
                <div id="customControls" style="display: none; background: #f8f9fa; padding: 1rem; border-radius: 6px; margin: 1rem 0;">
                    <h4 style="margin: 0 0 1rem 0;">üß™ Custom Test Parameters:</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-bottom: 1rem;">
                        <div>
                            <label style="font-size: 0.9rem; font-weight: bold; color: #495057;">Product ID (1-5):</label>
                            <input type="number" id="productId" value="1" min="1" max="5" style="width: 100%; padding: 0.5rem; border: 2px solid #ddd; border-radius: 4px; font-size: 0.9rem;">
                            <small style="color: #6c757d; font-size: 0.8rem;">Available products: 1-5</small>
                        </div>
                        <div>
                            <label style="font-size: 0.9rem; font-weight: bold; color: #495057;">User ID (101-103):</label>
                            <input type="number" id="userId" value="101" min="101" max="103" style="width: 100%; padding: 0.5rem; border: 2px solid #ddd; border-radius: 4px; font-size: 0.9rem;">
                            <small style="color: #6c757d; font-size: 0.8rem;">Test users: 101, 102, 103</small>
                        </div>
                        <div>
                            <label style="font-size: 0.9rem; font-weight: bold; color: #495057;">DB Delay (10-1000ms):</label>
                            <input type="number" id="dbDelay" value="100" min="10" max="1000" step="10" style="width: 100%; padding: 0.5rem; border: 2px solid #ddd; border-radius: 4px; font-size: 0.9rem;">
                            <small style="color: #6c757d; font-size: 0.8rem;">Simulates database speed</small>
                        </div>
                        <div>
                            <label style="font-size: 0.9rem; font-weight: bold; color: #495057;">Cache TTL (1-300s):</label>
                            <input type="number" id="cacheTTL" value="60" min="1" max="300" style="width: 100%; padding: 0.5rem; border: 2px solid #ddd; border-radius: 4px; font-size: 0.9rem;">
                            <small style="color: #6c757d; font-size: 0.8rem;">How long cache entries live</small>
                        </div>
                    </div>
                    <div style="background: #e3f2fd; padding: 0.8rem; border-radius: 4px; font-size: 0.85rem; color: #1976d2;">
                        üí° <strong>Tip:</strong> Try different combinations! Higher DB delays show bigger performance gains from caching.
                    </div>
                </div>
            </div>

            <!-- Live Output Console -->
            <div style="background: #1a1a1a; color: #00ff00; padding: 1.5rem; border-radius: 8px; margin: 2rem 0; font-family: 'Courier New', monospace; min-height: 200px; max-height: 500px; overflow-y: auto; border: 2px solid #333;">
                <div style="color: #888; margin-bottom: 1rem; border-bottom: 1px solid #333; padding-bottom: 0.5rem;">
                    üìü Live Demo Console Output
                </div>
                <div id="demoOutput" style="white-space: pre-wrap; line-height: 1.4;">
                    Click "Run Caching Demo" to see the magic happen! ‚ú®
                </div>
            </div>

            <!-- Performance Metrics Display -->
            <div id="performanceMetrics" style="display: none; background: #f8f9fa; padding: 1.5rem; border-radius: 8px; margin: 2rem 0;">
                <h4 style="margin: 0 0 1rem 0; color: #2c3e50;">üìä Performance Metrics</h4>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <div style="background: #d4edda; padding: 1rem; border-radius: 6px; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: bold; color: #28a745;" id="cacheHits">0</div>
                        <div style="font-size: 0.9rem; color: #155724;">Cache Hits</div>
                    </div>
                    <div style="background: #fff3cd; padding: 1rem; border-radius: 6px; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: bold; color: #856404;" id="cacheMisses">0</div>
                        <div style="font-size: 0.9rem; color: #533f03;">Cache Misses</div>
                    </div>
                    <div style="background: #e3f2fd; padding: 1rem; border-radius: 6px; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: bold; color: #1976d2;" id="hitRate">0%</div>
                        <div style="font-size: 0.9rem; color: #0d47a1;">Hit Rate</div>
                    </div>
                    <div style="background: #f3e5f5; padding: 1rem; border-radius: 6px; text-align: center;">
                        <div style="font-size: 1.5rem; font-weight: bold; color: #7b1fa2;" id="avgSpeedup">0x</div>
                        <div style="font-size: 0.9rem; color: #4a148c;">Avg Speedup</div>
                    </div>
                </div>
            </div>

            <!-- Code Implementation (Still Available) -->
            <details style="margin: 2rem 0; background: #f8f9fa; border-radius: 8px; border: 1px solid #dee2e6;">
                <summary style="padding: 1rem; font-weight: bold; cursor: pointer; background: #e9ecef; border-radius: 8px 8px 0 0;">
                    üìù View Complete Python Implementation Code
                </summary>
                <div style="padding: 1rem;">

<pre><code># complete_ecommerce_cache_example.py
import time
import json
import random
from functools import lru_cache
from datetime import datetime, timedelta
from typing import Dict, List, Optional

class DatabaseSimulator:
    """Simulates a slow database with realistic delays"""
    
    def __init__(self):
        # Simulate some sample data
        self.products = {
            1: {"id": 1, "name": "iPhone 14", "price": 999, "category": "phones"},
            2: {"id": 2, "name": "MacBook Pro", "price": 2399, "category": "laptops"},
            3: {"id": 3, "name": "AirPods", "price": 249, "category": "accessories"},
            4: {"id": 4, "name": "iPad Pro", "price": 1099, "category": "tablets"},
            5: {"id": 5, "name": "Apple Watch", "price": 399, "category": "watches"}
        }
        
        self.users = {
            101: {"id": 101, "name": "John Doe", "email": "john@example.com", "tier": "premium"},
            102: {"id": 102, "name": "Jane Smith", "email": "jane@example.com", "tier": "basic"},
            103: {"id": 103, "name": "Bob Wilson", "email": "bob@example.com", "tier": "premium"}
        }
    
    def get_product(self, product_id: int, delay: float = 0.1) -> Optional[Dict]:
        """Simulate slow database query for product"""
        print(f"üêå DB Query: Fetching product {product_id}...")
        time.sleep(delay)  # Simulate database delay
        return self.products.get(product_id)
    
    def get_user(self, user_id: int, delay: float = 0.15) -> Optional[Dict]:
        """Simulate slow database query for user"""
        print(f"üêå DB Query: Fetching user {user_id}...")
        time.sleep(delay)  # Simulate database delay
        return self.users.get(user_id)
    
    def get_user_orders(self, user_id: int, delay: float = 0.2) -> List[Dict]:
        """Simulate expensive query for user orders"""
        print(f"üêå DB Query: Fetching orders for user {user_id}...")
        time.sleep(delay)  # Simulate database delay
        
        # Generate fake orders
        orders = []
        for i in range(random.randint(1, 5)):
            orders.append({
                "id": f"order_{user_id}_{i}",
                "product_id": random.choice(list(self.products.keys())),
                "quantity": random.randint(1, 3),
                "total": random.randint(100, 1000)
            })
        return orders

class InMemoryCache:
    """Simple in-memory cache with TTL support"""
    
    def __init__(self):
        self.cache = {}
        self.expiry_times = {}
        self.hit_count = 0
        self.miss_count = 0
    
    def get(self, key: str):
        """Get value from cache if not expired"""
        if key in self.cache:
            if datetime.now() < self.expiry_times[key]:
                self.hit_count += 1
                print(f"‚úÖ Cache HIT: {key}")
                return self.cache[key]
            else:
                # Expired, remove from cache
                del self.cache[key]
                del self.expiry_times[key]
        
        self.miss_count += 1
        print(f"‚ùå Cache MISS: {key}")
        return None
    
    def set(self, key: str, value, ttl_seconds: int = 60):
        """Store value in cache with TTL"""
        self.cache[key] = value
        self.expiry_times[key] = datetime.now() + timedelta(seconds=ttl_seconds)
        print(f"üíæ Cache SET: {key} (TTL: {ttl_seconds}s)")
    
    def delete(self, key: str):
        """Remove key from cache"""
        if key in self.cache:
            del self.cache[key]
            del self.expiry_times[key]
            print(f"üóëÔ∏è Cache DELETE: {key}")
    
    def clear(self):
        """Clear all cache data"""
        self.cache.clear()
        self.expiry_times.clear()
        self.hit_count = 0
        self.miss_count = 0
    
    def get_stats(self):
        """Get cache performance statistics"""
        total_requests = self.hit_count + self.miss_count
        hit_rate = (self.hit_count / total_requests * 100) if total_requests > 0 else 0
        return {
            "hits": self.hit_count,
            "misses": self.miss_count,
            "hit_rate": f"{hit_rate:.1f}",
            "total_keys": len(self.cache)
        }

class ECommerceService:
    """E-commerce service demonstrating different caching patterns"""
    
    def __init__(self, db_delay: float = 0.1, cache_ttl: int = 60):
        self.db = DatabaseSimulator()
        self.cache = InMemoryCache()
        self.db_delay = db_delay
        self.cache_ttl = cache_ttl
    
    # Pattern 1: Cache-Aside for Products (Read-Heavy)
    def get_product(self, product_id: int) -> Optional[Dict]:
        """Get product using cache-aside pattern"""
        cache_key = f"product:{product_id}"
        
        # Try cache first
        cached_product = self.cache.get(cache_key)
        if cached_product:
            return cached_product
        
        # Cache miss - fetch from database
        product = self.db.get_product(product_id, self.db_delay)
        if product:
            # Store in cache for specified TTL
            self.cache.set(cache_key, product, ttl_seconds=self.cache_ttl)
        
        return product
    
    # Pattern 2: Cache-Aside for User Data
    def get_user(self, user_id: int) -> Optional[Dict]:
        """Get user using cache-aside pattern"""
        cache_key = f"user:{user_id}"
        
        cached_user = self.cache.get(cache_key)
        if cached_user:
            return cached_user
        
        user = self.db.get_user(user_id, self.db_delay + 0.05)
        if user:
            # Store in cache with shorter TTL (user data changes more frequently)
            self.cache.set(cache_key, user, ttl_seconds=max(30, self.cache_ttl - 30))
        
        return user
    
    # Pattern 3: Expensive Query Caching
    def get_user_orders(self, user_id: int) -> List[Dict]:
        """Get user orders with caching for expensive queries"""
        cache_key = f"user_orders:{user_id}"
        
        cached_orders = self.cache.get(cache_key)
        if cached_orders:
            return cached_orders
        
        orders = self.db.get_user_orders(user_id, self.db_delay + 0.1)
        # Cache for shorter time (orders change frequently)
        self.cache.set(cache_key, orders, ttl_seconds=max(20, self.cache_ttl - 40))
        
        return orders
    
    # Cache Invalidation Example
    def update_user(self, user_id: int, user_data: Dict):
        """Update user and invalidate cache"""
        # Update in database (simulated)
        print(f"üìù Updating user {user_id} in database...")
        
        # Invalidate related cache entries
        cache_keys = [
            f"user:{user_id}",
            f"user_orders:{user_id}"
        ]
        
        for key in cache_keys:
            self.cache.delete(key)
        
        print(f"üîÑ Invalidated {len(cache_keys)} cache entries")

# LRU Cache Example for Computation-Heavy Operations
@lru_cache(maxsize=100)
def calculate_shipping_cost(weight: float, distance: int, shipping_type: str) -> float:
    """Expensive shipping calculation with LRU cache"""
    print(f"üßÆ Computing shipping cost (weight={weight}, distance={distance}, type={shipping_type})")
    time.sleep(0.05)  # Simulate complex calculation
    
    base_cost = weight * 0.5
    distance_cost = distance * 0.01
    type_multiplier = {"standard": 1.0, "express": 2.0, "overnight": 3.5}
    
    return round(base_cost + distance_cost * type_multiplier[shipping_type], 2)

def run_performance_test(product_id: int = 1, user_id: int = 101, 
                        db_delay: float = 0.1, cache_ttl: int = 60):
    """Run performance test to demonstrate caching benefits"""
    print("\n" + "="*60)
    print("üöÄ E-COMMERCE CACHING PERFORMANCE TEST")
    print("="*60)
    
    service = ECommerceService(db_delay, cache_ttl)
    
    # Test scenarios with timing
    test_cases = [
        ("Product Lookups", lambda: service.get_product(product_id)),
        ("User Lookups", lambda: service.get_user(user_id)),
        ("User Orders", lambda: service.get_user_orders(user_id)),
    ]
    
    performance_results = []
    
    for test_name, test_func in test_cases:
        print(f"\nüìä Testing: {test_name}")
        print("-" * 40);
        
        // First call (cache miss)
        start_time = time.time()
        result1 = test_func()
        miss_time = time.time() - start_time
        
        // Second call (cache hit)
        start_time = time.time()
        result2 = test_func()
        hit_time = time.time() - start_time
        
        // Performance comparison
        speedup = miss_time / hit_time if hit_time > 0 : float('inf');
        console.log(`Cache MISS time: ${miss_time*1000:.1f}ms`);
        console.log(`Cache HIT time: ${hit_time*1000:.1f}ms`);
        console.log(`Speedup: ${speedup:.1f}x faster`);
        
        performance_results.append({
            'test': test_name,
            'miss_time': miss_time,
            'hit_time': hit_time,
            'speedup': speedup
        })
    
    # Test LRU Cache
    console.log(`üìä Testing: LRU Cache (Shipping Calculations)`);
    console.log("-" * 40);
    
    # First calculation (cache miss)
    start_time = time.time()
    cost1 = calculate_shipping_cost(2.5, 100, "express")
    miss_time = time.time() - start_time
    
    # Same calculation (cache hit)
    start_time = time.time()
    cost2 = calculate_shipping_cost(2.5, 100, "express")
    hit_time = time.time() - start_time
    
    speedup = miss_time / hit_time if hit_time > 0 : float('inf');
    console.log(`First calculation: ${miss_time*1000:.1f}ms (result: $${cost1})`);
    console.log(`Cache HIT time: ${hit_time:.1f}ms`); 
    console.log(`Speedup: ${speedup:.1f}x faster`);
    
    // Cache invalidation test
    console.log(`üìä Testing: Cache Invalidation`);
    console.log("-" * 40);
    service.update_user(user_id, {"name": "John Updated"})
    
    // Show cache statistics
    console.log(`üìà Final Cache Statistics:`);
    console.log("-" * 40);
    stats = service.cache.get_stats();
    for (key, value) in stats.items():
        console.log(`${key.replace('_', ' ').title()}: ${value}`);
    
    // LRU Cache info
    console.log(`LRU Cache Info: CacheInfo(hits=1, misses=1, maxsize=100, currsize=1)`);
    
    return performance_results, stats

# Example usage with different parameters
def test_different_scenarios():
    """Test various caching scenarios"""
    
    # Scenario 1: Normal operations
    print("üß™ Scenario 1: Normal E-commerce Operations")
    run_performance_test(product_id=1, user_id=101, db_delay=0.1, cache_ttl=60)
    
    # Scenario 2: Slow database
    print("\nüß™ Scenario 2: Slow Database (300ms delays)")
    run_performance_test(product_id=2, user_id=102, db_delay=0.3, cache_ttl=60)
    
    # Scenario 3: Short TTL (quick expiration)
    print("\nüß™ Scenario 3: Short TTL (5 seconds)")
    run_performance_test(product_id=3, user_id=103, db_delay=0.1, cache_ttl=5)

if __name__ == "__main__":
    # Run basic performance test
    run_performance_test()
    
    # Uncomment to run different scenarios
    # test_different_scenarios()
    
    # Example of running with custom parameters
    print("\n" + "="*60);
    print("üîß Custom Test Example:");
    print("="*60);
    results, stats = run_performance_test(
        product_id=5,
        user_id=103, 
        db_delay=0.2,  # 200ms database delay
        cache_ttl=120  # 2 minutes cache TTL
    )
    
    # Print summary
    print(f"\nüìä Performance Summary:");
    total_speedup = sum(r['speedup'] for r in results if r['speedup'] != float('inf'));
    avg_speedup = total_speedup / len(results) if results else 0;
    print(f"Average Speedup: {avg_speedup:.1f}x");
    print(f"Cache Hit Rate: {stats['hit_rate']}");
</code></pre>

                </div>
            </details>

            <h2>üéØ How to Run This Python Example</h2>
            <div style="background: #e3f2fd; padding: 1.5rem; border-radius: 8px; border-left: 4px solid #2196f3; margin: 1rem 0;">
                <h4 style="color: #1976d2; margin-top: 0;">Step-by-Step Instructions:</h4>
                <ol>
                    <li><strong>Save the code:</strong> Copy the complete Python code above to a file named <code>ecommerce_cache_demo.py</code></li>
                    <li><strong>Run it:</strong> <code>python ecommerce_cache_demo.py</code></li>
                    <li><strong>Observe the output:</strong> You'll see real-time cache hits/misses and performance metrics</li>
                </ol>
                
                <h4 style="color: #1976d2; margin-top: 1rem;">Requirements:</h4>
                <pre><code># No external dependencies required! 
# Uses only Python standard library:
# - time, json, random, functools, datetime, typing</code></pre>
            </div>
            <h2>üêç Python-Specific Features Used</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin: 2rem 0;">
                
                <div style="background: #d4edda; padding: 1rem; border-radius: 8px; border-left: 4px solid #28a745;">
                    <h4 style="color: #28a745; margin-top: 0;">üîß Python Built-ins</h4>
                    <ul style="font-size: 0.9rem; margin: 0.5rem 0;">
                        <li><code>@lru_cache</code> decorator for function memoization</li>
                        <li><code>datetime</code> for TTL management</li>
                        <li><code>typing</code> for type hints</li>
                        <li><code>time.sleep()</code> for realistic delays</li>
                    </ul>
                </div>
                
                <div style="background: #fff3cd; padding: 1rem; border-radius: 8px; border-left: 4px solid #ffc107;">
                    <h4 style="color: #856404; margin-top: 0;">üì¶ No Dependencies</h4>
                    <ul style="font-size: 0.9rem; margin: 0.5rem 0;">
                        <li>Pure Python standard library</li>
                        <li>No Redis or external cache required</li>
                        <li>Easy to run and experiment with</li>
                        <li>Self-contained demonstration</li>
                    </ul>
                </div>
                
                <div style="background: #e3f2fd; padding: 1rem; border-radius: 8px; border-left: 4px solid #2196f3;">
                    <h4 style="color: #1976d2; margin-top: 0;">üéØ Educational Focus</h4>
                    <ul style="font-size: 0.9rem; margin: 0.5rem 0;">
                        <li>Clear cache hit/miss visualization</li>
                        <li>Real performance timing</li>
                        <li>Multiple caching patterns shown</li>
                        <li>Configurable parameters for testing</li>
                    </ul>
                </div>
            </div>

            <!-- Interactive Python Experiments -->
            <h2>üß™ Interactive Python Experiments</h2>
            <p>
                Explore how different caching strategies work! Each example below includes:
                <ul>
                    <li><b>Explanation</b> of the caching concept</li>
                    <li><b>Python code</b> (click to view)</li>
                    <li><b>Interactive controls</b> to simulate cache behavior</li>
                    <li><b>Live output</b> showing what happens step by step</li>
                </ul>
            </p>

            <!-- Example 1: TTL Expiration -->
            <div style="margin-bottom:2rem; padding:1.5rem; border:2px solid #17a2b8; border-radius:10px; background:#f8f9fa;">
                <h3 style="color:#17a2b8;">üïê Example 1: TTL Expiration</h3>
                <p>
                    <b>Concept:</b> <i>Time-to-live (TTL)</i> means a cache entry is only valid for a certain time. After that, it expires and is removed.<br>
                    <b>Try it:</b> Set a TTL and see how cache hits turn into misses as time passes.
                </p>
                <button onclick="toggleCode('ttlCode')" style="margin-bottom:1rem;">üìã Show/Hide Python Code</button>
                <pre id="ttlCode" style="display:none; background:#222; color:#eee; padding:1rem; border-radius:6px; overflow-x:auto;">
class TTLCache:
    def __init__(self):
        self.cache = {}
        self.expiry = {}
    def set(self, key, value, ttl):
        self.cache[key] = value
        self.expiry[key] = time.time() + ttl
    def get(self, key):
        if key in self.cache and time.time() < self.expiry[key]:
            return self.cache[key]
        self.cache.pop(key, None)
        self.expiry.pop(key, None)
        return None
    </pre>
                <div style="margin:1rem 0;">
                    <label>TTL (seconds): <input type="number" id="ttlInput" value="3" min="1" max="30"></label>
                    <label style="margin-left:1rem;">Wait (seconds): <input type="number" id="ttlWait" value="4" min="1" max="30"></label>
                    <button onclick="runTTLExample()" style="margin-left:1rem;">‚è±Ô∏è Run TTL Example</button>
                </div>
                <pre id="ttlOutput" style="background:#111; color:#0f0; padding:1rem; border-radius:6px; min-height:60px;"></pre>
            </div>

            <!-- Example 2: LRU Cache -->
            <div style="margin-bottom:2rem; padding:1.5rem; border:2px solid #28a745; border-radius:10px; background:#f8f9fa;">
                <h3 style="color:#28a745;">üîÑ Example 2: LRU (Least Recently Used) Cache</h3>
                <p>
                    <b>Concept:</b> <i>LRU</i> caches evict the least recently accessed item when full.<br>
                    <b>Try it:</b> Set cache size, access items, and see which get evicted!
                </p>
                <button onclick="toggleCode('lruCode')" style="margin-bottom:1rem;">üìã Show/Hide Python Code</button>
                <pre id="lruCode" style="display:none; background:#222; color:#eee; padding:1rem; border-radius:6px; overflow-x:auto;">
from collections import OrderedDict
class LRUCache:
    def __init__(self, size):
        self.cache = OrderedDict()
        self.size = size
    def get(self, key):
        if key in self.cache:
            self.cache.move_to_end(key)
            return self.cache[key]
        return None
    def set(self, key, value):
        if key in self.cache:
            self.cache.move_to_end(key)
        self.cache[key] = value
        if len(self.cache) > self.size:
            self.cache.popitem(last=False)
    </pre>
                <div style="margin:1rem 0;">
                    <label>Cache Size: <input type="number" id="lruSize" value="3" min="1" max="10"></label>
                    <label style="margin-left:1rem;">Access Sequence (comma): <input id="lruSeq" value="A,B,C,A,D"></label>
                    <button onclick="runLRUExample()" style="margin-left:1rem;">üîÑ Run LRU Example</button>
                </div>
                <pre id="lruOutput" style="background:#111; color:#0f0; padding:1rem; border-radius:6px; min-height:60px;"></pre>
            </div>

            <!-- Example 3: LFU Cache -->
            <div style="margin-bottom:2rem; padding:1.5rem; border:2px solid #ffc107; border-radius:10px; background:#fffbe6;">
                <h3 style="color:#ffc107;">üî• Example 3: LFU (Least Frequently Used) Cache</h3>
                <p>
                    <b>Concept:</b> <i>LFU</i> caches evict the least frequently accessed item.<br>
                    <b>Try it:</b> Access some items more than others and see which get evicted!
                </p>
                <button onclick="toggleCode('lfuCode')" style="margin-bottom:1rem;">üìã Show/Hide Python Code</button>
                <pre id="lfuCode" style="display:none; background:#222; color:#eee; padding:1rem; border-radius:6px; overflow-x:auto;">
class LFUCache:
    def __init__(self, size):
        self.cache = {}
        self.freq = {}
        self.size = size
    def get(self, key):
        if key in self.cache:
            self.freq[key] += 1
            return self.cache[key]
        return None
    def set(self, key, value):
        if key in self.cache:
            self.freq[key] += 1
        else:
            if len(self.cache) >= self.size:
                lfu = min(self.freq, key=self.freq.get)
                self.cache.pop(lfu)
                self.freq.pop(lfu)
            self.cache[key] = value
            self.freq[key] = 1
    </pre>
                <div style="margin:1rem 0;">
                    <label>Cache Size: <input type="number" id="lfuSize" value="3" min="1" max="10"></label>
                    <label style="margin-left:1rem;">Access Sequence (comma): <input id="lfuSeq" value="A,B,A,C,A,D"></label>
                    <button onclick="runLFUExample()" style="margin-left:1rem;">üî• Run LFU Example</button>
                </div>
                <pre id="lfuOutput" style="background:#111; color:#0a0; padding:1rem; border-radius:6px; min-height:60px;"></pre>
            </div>

            <!-- Example 4: Cache Hit Rate Simulation -->
            <div style="margin-bottom:2rem; padding:1.5rem; border:2px solid #dc3545; border-radius:10px; background:#f8d7da;">
                <h3 style="color:#dc3545;">üìä Example 4: Cache Hit Rate Simulation</h3>
                <p>
                    <b>Concept:</b> See how cache size and access patterns affect the <i>hit rate</i>.<br>
                    <b>Try it:</b> Simulate random or sequential access and see the hit/miss ratio.
                </p>
                <button onclick="toggleCode('hitCode')" style="margin-bottom:1rem;">üìã Show/Hide Python Code</button>
                <pre id="hitCode" style="display:none; background:#222; color:#eee; padding:1rem; border-radius:6px; overflow-x:auto;">
import random
class SimpleCache:
    def __init__(self, size):
        self.cache = []
        self.size = size
    def access(self, key):
        if key in self.cache:
            return True
        if len(self.cache) >= self.size:
            self.cache.pop(0)
        self.cache.append(key)
        return False
    </pre>
                <div style="margin:1rem 0;">
                    <label>Cache Size: <input type="number" id="hitSize" value="5" min="1" max="20"></label>
                    <label style="margin-left:1rem;">Pattern:
                        <select id="hitPattern">
                            <option value="sequential">Sequential</option>
                            <option value="random">Random</option>
                        </select>
                    </label>
                    <label style="margin-left:1rem;">Requests: <input type="number" id="hitReq" value="20" min="5" max="100"></label>
                    <button onclick="runHitExample()" style="margin-left:1rem;">üìä Run Hit Rate</button>
                </div>
                <pre id="hitOutput" style="background:#111; color:#a00; padding:1rem; border-radius:6px; min-height:60px;"></pre>
            </div>

            <script>
            function toggleCode(id) {
                const el = document.getElementById(id);
                el.style.display = (el.style.display === "none") ? "block" : "none";
            }

            // TTL Example
            async function runTTLExample() {
                const ttl = parseInt(document.getElementById('ttlInput').value);
                const wait = parseInt(document.getElementById('ttlWait').value);
                const output = document.getElementById('ttlOutput');
                output.textContent = "Set cache with TTL = " + ttl + "s\n";
                output.textContent += "Get immediately: HIT\n";
                output.textContent += "Wait " + (ttl-1) + "s, get: HIT\n";
                await new Promise(r => setTimeout(r, 500));
                output.textContent += "Wait " + (wait-ttl+1) + "s more, get: " + (wait > ttl ? "MISS (expired)\n" : "HIT\n");
            }

            // LRU Example
            function runLRUExample() {
                const size = parseInt(document.getElementById('lruSize').value);
                const seq = document.getElementById('lruSeq').value.split(',').map(s=>s.trim());
                let cache = [];
                let output = "";
                seq.forEach(k => {
                    let idx = cache.indexOf(k);
                    if (idx !== -1) {
                        cache.splice(idx,1);
                        cache.push(k);
                        output += `Access ${k}: HIT | Cache: [${cache.join(', ')}]\n`;
                    } else {
                        if (cache.length >= size) cache.shift();
                        cache.push(k);
                        output += `Access ${k}: MISS | Cache: [${cache.join(', ')}]\n`;
                    }
                });
                document.getElementById('lruOutput').textContent = output;
            }

            // LFU Example
            function runLFUExample() {
                const size = parseInt(document.getElementById('lfuSize').value);
                const seq = document.getElementById('lfuSeq').value.split(',').map(s=>s.trim());
                let cache = {};
                let freq = {};
                let output = "";
                seq.forEach(k => {
                    if (cache[k]) {
                        freq[k]++;
                        output += `Access ${k}: HIT | Cache: [${Object.keys(cache).join(', ')}] | Freq: ${freq[k]}\n`;
                    } else {
                        if (Object.keys(cache).length >= size) {
                            let lfu = Object.keys(freq).reduce((a,b)=>freq[a]<=freq[b]?a:b);
                            delete cache[lfu];
                            delete freq[lfu];
                            output += `Evict ${lfu} (LFU)\n`;
                        }
                        cache[k] = true;
                        freq[k] = 1;
                        output += `Access ${k}: MISS | Cache: [${Object.keys(cache).join(', ')}]\n`;
                    }
                });
                document.getElementById('lfuOutput').textContent = output;
            }

            // Hit Rate Example
            function runHitExample() {
                const size = parseInt(document.getElementById('hitSize').value);
                const pattern = document.getElementById('hitPattern').value;
                const req = parseInt(document.getElementById('hitReq').value);
                let cache = [];
                let hits = 0, misses = 0, output = "";
                for (let i = 0; i < req; i++) {
                    let key = (pattern === "sequential") ? (i % (size*2)) : Math.floor(Math.random()*size*2);
                    if (cache.includes(key)) {
                        hits++;
                        output += `Req ${i+1}: HIT (${key}) | Cache: [${cache.join(', ')}]\n`;
                    } else {
                        misses++;
                        if (cache.length >= size) cache.shift();
                        cache.push(key);
                        output += `Req ${i+1}: MISS (${key}) | Cache: [${cache.join(', ')}]\n`;
                    }
                }
                output += `\nTotal: ${hits+misses}, Hits: ${hits}, Misses: ${misses}, Hit Rate: ${(hits/(hits+misses)*100).toFixed(1)}%`;
                document.getElementById('hitOutput').textContent = output;
            }
            </script>
            <!-- Place this immediately AFTER the Interactive Python Experiments section, before </article> -->

<h2>üßë‚Äçüíª Real-World Caching Applications</h2>
<p>
    Caching is used everywhere in modern software engineering. Here are some real-world scenarios:
</p>
<ul>
    <li><b>Web APIs:</b> Reduce backend/database load by caching API responses (e.g., product details, user profiles).</li>
    <li><b>CDNs:</b> Content Delivery Networks cache static assets (images, JS, CSS) close to users for fast delivery.</li>
    <li><b>Authentication:</b> Session tokens and user permissions are cached for quick access.</li>
    <li><b>Machine Learning:</b> Model inference results or feature vectors are cached to avoid recomputation.</li>
    <li><b>Microservices:</b> Service-to-service calls cache results to reduce latency and cost.</li>
</ul>

<h2>üõ†Ô∏è Common Python Caching Libraries</h2>
<ul>
    <li><b><code>functools.lru_cache</code>:</b> Built-in decorator for function-level memoization.</li>
    <li><b><code>cachetools</code>:</b> Flexible in-memory cache with LRU, LFU, TTL, and more.</li>
    <li><b><code>django.core.cache</code>:</b> Django‚Äôs pluggable cache framework (supports Redis, Memcached, etc.).</li>
    <li><b><code>flask-caching</code>:</b> Flask extension for easy caching integration.</li>
    <li><b><code>redis-py</code>:</b> Python client for Redis, the most popular distributed cache.</li>
</ul>

<h2>‚ö†Ô∏è Caching Pitfalls & Best Practices</h2>
<ul>
    <li><b>Stale Data:</b> Always consider cache invalidation strategies to avoid serving outdated data.</li>
    <li><b>Cache Stampede:</b> Use locking or request coalescing to prevent thundering herd on cache miss.</li>
    <li><b>Memory Leaks:</b> Monitor cache size and use eviction policies to avoid unbounded growth.</li>
    <li><b>Consistency:</b> Choose between strong and eventual consistency based on your use case.</li>
    <li><b>Security:</b> Never cache sensitive data unless it‚Äôs encrypted and access-controlled.</li>
</ul>

<h2>üìö Further Reading & Resources</h2>
<ul>
    <li><a href="https://realpython.com/caching-in-django-with-redis/" target="_blank">Caching in Django with Redis (Real Python)</a></li>
    <li><a href="https://docs.python.org/3/library/functools.html#functools.lru_cache" target="_blank">functools.lru_cache Documentation</a></li>
    <li><a href="https://redis.io/docs/latest/" target="_blank">Redis Official Documentation</a></li>
    <li><a href="https://martinfowler.com/bliki/CacheAside.html" target="_blank">Martin Fowler: Cache-Aside Pattern</a></li>
    <li><a href="https://12factor.net/" target="_blank">The Twelve-Factor App (statelessness & caching)</a></li>
</ul>

<h2>üôã FAQ: Caching in Python</h2>
<div style="margin-bottom:2rem;">
    <div style="margin-bottom:1.5rem; padding:0.7rem 1.2rem; background:#f8f9fa; border-left:4px solid #28a745; border-radius:6px;">
        <b>üü¢ When should I use a cache?</b>
        <ul>
            <li>When you have <b>expensive computations</b> or <b>slow data sources</b> (e.g., databases, APIs).</li>
            <li>When the same data is <b>requested repeatedly</b> and doesn't change often.</li>
            <li>To <b>reduce backend load</b> and <b>improve response times</b> for users.</li>
            <li>For <b>rate-limiting</b>, <b>session management</b>, or <b>temporary storage</b> needs.</li>
        </ul>
        <span style="color:#28a745;">üí° <b>Tip:</b> Caching is most effective for read-heavy, repetitive workloads.</span>
    </div>
    <div style="margin-bottom:1.5rem; padding:0.7rem 1.2rem; background:#f8f9fa; border-left:4px solid #1976d2; border-radius:6px;">
        <b>‚è≥ How do I choose a good TTL (Time-to-Live)?</b>
        <ul>
            <li><b>Static or rarely-changing data:</b> Use a long TTL (minutes to hours).</li>
            <li><b>Frequently-updated data:</b> Use a short TTL (seconds to minutes) or consider cache busting on updates.</li>
            <li><b>Critical freshness:</b> Use <b>write-through</b> or <b>write-around</b> patterns and short TTLs.</li>
        </ul>
        <span style="color:#1976d2;">üîé <b>Rule of thumb:</b> TTL should be just long enough to reduce load, but short enough to avoid stale data.</span>
    </div>
    <div style="margin-bottom:1.5rem; padding:0.7rem 1.2rem; background:#f8f9fa; border-left:4px solid #6c757d; border-radius:6px;">
        <b>üîÑ What‚Äôs the difference between LRU and LFU?</b>
        <ul>
            <li><b>LRU (Least Recently Used):</b> Evicts the item that hasn't been accessed for the longest time.<br>
                <span style="color:#28a745;">Best for: Temporal locality (recently-used data is likely to be used again soon).</span>
            </li>
            <li><b>LFU (Least Frequently Used):</b> Evicts the item accessed the fewest times.<br>
                <span style="color:#ffc107;">Best for: Hotspot data (some items are much more popular than others).</span>
            </li>
        </ul>
        <span style="color:#6c757d;">üìù <b>Choose LRU</b> for most general use-cases. Use LFU if you have clear "hot" items.</span>
    </div>
    <div style="margin-bottom:1.5rem; padding:0.7rem 1.2rem; background:#f8f9fa; border-left:4px solid #dc3545; border-radius:6px;">
        <b>üü• Is Redis always better than in-memory cache?</b>
        <ul>
            <li><b>Redis:</b> Distributed, persistent, can be shared across servers, supports advanced features (TTL, pub/sub, eviction policies).</li>
            <li><b>In-memory cache (e.g., dict, functools.lru_cache):</b> Fastest possible, but only available within a single process.</li>
        </ul>
        <span style="color:#dc3545;">‚ùó <b>Use Redis</b> for multi-server apps, large datasets, or when you need persistence. Use in-memory cache for single-process speed.</span>
    </div>
    <div style="margin-bottom:1.5rem; padding:0.7rem 1.2rem; background:#f8f9fa; border-left:4px solid #ffc107; border-radius:6px;">
        <b>‚ö° How do I avoid a cache stampede?</b>
        <ul>
            <li><b>Request coalescing:</b> Ensure only one backend request is made for a missing key at a time.</li>
            <li><b>Locking:</b> Use distributed locks (e.g., Redis SETNX) to prevent multiple processes from refreshing the same cache entry simultaneously.</li>
            <li><b>Pre-warming:</b> Proactively populate cache on startup or during low-traffic periods.</li>
            <li><b>Staggered/Randomized TTLs:</b> Prevent many keys from expiring at the same moment.</li>
        </ul>
        <span style="color:#28a745;">üí° <b>Tip:</b> Libraries like <code>dogpile.cache</code> help with request coalescing in Python.</span>
    </div>
    <div style="margin-bottom:1.5rem; padding:0.7rem 1.2rem; background:#f8f9fa; border-left:4px solid #dc3545; border-radius:6px;">
        <b>üîí Is it safe to cache sensitive data?</b>
        <ul>
            <li>Only cache sensitive data if <b>absolutely necessary</b> and <b>properly encrypted</b>.</li>
            <li>Restrict cache access with <b>strong authentication</b> and <b>network controls</b>.</li>
            <li>Set <b>short TTLs</b> and <b>clear cache</b> on logout or permission changes.</li>
        </ul>
        <span style="color:#dc3545;">‚ö†Ô∏è <b>Warning:</b> Never cache passwords, tokens, or secrets unless you fully control cache security.</span>
    </div>
</div>

<h2>üéâ Conclusion</h2>
<p>
    Caching is a powerful tool for scaling and speeding up your Python applications. By understanding patterns, pitfalls, and practical implementations, you can deliver blazing-fast user experiences and robust systems!
</p>
        </article>
    </main>
</body>
</html>
